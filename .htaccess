Options -Indexes -Multiviews

DirectoryIndex index.php

# Ensure PHP gets the original request URI for routing if needed
RewriteEngine On

# Serve homepage normally
RewriteRule ^$ index.php [L]

# Block .env and dotfiles by sending 404 (path-agnostic)
RewriteRule (^|/)\.env(\..*)?$ 404.php [L]
RewriteRule (^|/)\..+ 404.php [L]

# Allow only existing PHP files
RewriteCond %{REQUEST_FILENAME} -f
RewriteRule \.php$ - [L]

# If the request is a directory, show 404
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^ 404.php [L]

# If the file exists but is not PHP, show 404
RewriteCond %{REQUEST_FILENAME} -f
RewriteCond %{REQUEST_URI} !\.php$ [NC]
RewriteRule ^ 404.php [L]

# Otherwise, let 404 handle non-existing paths directly
RewriteRule ^.*$ 404.php [L]


